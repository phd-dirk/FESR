#include "./numerics.hpp"

double Numerics::nonAdaptiveIntegrate(func f, double from, double to) {
  double result, error;
  gsl_integration_workspace * w_ = gsl_integration_workspace_alloc(1100);
  gsl_function F;
  F = {
    [](double d, void* vf) -> double {
      auto& f = *static_cast<std::function<double(double)>*>(vf);
      return f(d);
    },
    &f
  };
  size_t fCalls;
  gsl_integration_qng(&F, from, to, 1e-6, 0.0, &result, &error, &fCalls);
  return result;
}

double Numerics::adaptiveIntegrate(func f, double from, double to) {
  double result, error;
  gsl_integration_workspace * w_ = gsl_integration_workspace_alloc(1100);
  gsl_function F;
  F = {
    [](double d, void* vf) -> double {
      auto& f = *static_cast<std::function<double(double)>*>(vf);
      return f(d);
    },
    &f
  };
  gsl_integration_qag(&F, from, to, 1e-10, 0.0, 1100, 6, w_, &result, &error);
  return result;
}

double Numerics::gaussLegendre(func f, double from, double to) {
  double result, error;
  gsl_integration_glfixed_table * t = gsl_integration_glfixed_table_alloc(1100);
  gsl_function F;
  F = {
    [](double d, void* vf) -> double {
      auto& f = *static_cast<std::function<double(double)>*>(vf);
      return f(d);
    },
    &f
  };
  return gsl_integration_glfixed(&F, from, to, t);
}

std::complex<double> Numerics::integrateComplex(
  function<complex<double>(double)> func, double from, double to
) {
  auto funcReal = [func](double t) {
                    return func(t).real();
                  };
  auto funcImag = [func](double t) {
                    return func(t).imag();
                  };

  double cintReal = gaussLegendre(funcReal, from, to);
  double cintImag = gaussLegendre(funcImag, from, to);
  // double cintReal = adaptiveIntegrate(funcReal, from, to);
  // double cintImag = adaptiveIntegrate(funcImag, from, to);

  return complex<double>(cintReal, cintImag);
}

void Numerics::gauleg(const double &x1, const double &x2, vec &x, vec &w, const int &n) {
  double z1, z, pp, p3, p2, p1;
  int m = (n + 1)/2;
  double xm = 0.5*(x2+x1);
  double xl = 0.5*(x2-x1);

  for(int i = 0; i < m; i++) {
    z = cos(M_PI*(i + 0.75)/(n + 0.5));

    do {
      p1 = 1.;
      p2 = 0.;
      for(int j = 0; j < n; j++){
        p3 = p2;
        p2 = p1;
        p1 = ((2.*j + 1.)*z*p2 - j*p3)/(j+1);
      }
      pp = n*(z*p1 - p2)/(z*z - 1.);
      z1 = z;
      z = z1 - p1/pp;
    } while(abs(z - z1) > 1e-15);
    x[i] = xm - xl*z;
    x[n-1-i] = xm+xl*z;
    w[i] = 2.*xl/((1. - z*z)*pp*pp);
    w[n-1-i] = w[i];
  }
}


std::vector<double> Numerics::gaulegX = {
-3.141586360856659, 	-3.1415594976010106, 	-3.1415111687348847, 	-3.1414413638543479, 	-3.141350082121801, 	
-3.1412373238473208, 	-3.1411030896971908, 	-3.1409473805463977, 	-3.1407701974394291, 	
-3.1405715415772302, 	-3.1403514143121267, 	-3.1401098171456012, 	-3.1398467517272239, 	
-3.1395622198540978, 	-3.1392562234705501, 	-3.1389287646679489, 	-3.1385798456845868, 	
-3.1382094689056048, 	-3.1378176368629358, 	-3.1374043522352588, 	-3.1369696178479658, 	
-3.1365134366731282, 	-3.1360358118294696, 	-3.1355367465823365, 	-3.1350162443436753, 	
-3.1344743086720008, 	-3.1339109432723737, 	-3.1333261519963713, 	-3.1327199388420603, 	
-3.1320923079539678, 	-3.131443263623054, 	-3.1307728102866803, 	-3.1300809525285795, 	
-3.1293676950788232, 	-3.1286330428137896, 	-3.1278770007561314, 	-3.1270995740747383, 	
-3.126300768084703, 	-3.125480588247286, 	-3.124639040169876, 	-3.1237761296059521, 	
-3.1228918624550452, 	-3.1219862447626965, 	-3.1210592827204175, 	-3.1201109826656457, 	
-3.1191413510817032, 	-3.1181503945977505, 	-3.1171381199887427, 	-3.116104534175383, 	
-3.1150496442240736, 	-3.1139734573468698, 	-3.1128759809014293, 	-3.1117572223909611, 	
-3.1106171894641768, 	-3.1094558899152358, 	-3.108273331683693, 	-3.1070695228544443, 	
-3.1058444716576723, 	-3.1045981864687877, 	-3.1033306758083743, 	-3.1020419483421309, 	
-3.1007320128808096, 	-3.0994008783801568, 	-3.098048553940854, 	-3.0966750488084527, 	
-3.095280372373312, 	-3.0938645341705353, 	-3.092427543879904, 	-3.0909694113258124, 	
-3.0894901464771993, 	-3.0879897594474808, 	-3.0864682604944806, 	-3.0849256600203612, 	
-3.0833619685715496, 	-3.0817771968386696, 	-3.0801713556564643, 	-3.0785444560037258, 	
-3.076896509003217, 	-3.0752275259215986, 	-3.0735375181693492, 	-3.0718264973006884, 	
-3.0700944750134997, 	-3.0683414631492472, 	-3.0665674736928961, 	-3.0647725187728323, 	
-3.0629566106607768, 	-3.0611197617717041, 	-3.0592619846637552, 	-3.0573832920381538, 	
-3.0554836967391181, 	-3.0535632117537737, 	-3.0516218502120633, 	-3.0496596253866599, 	
-3.0476765506928731, 	-3.0456726396885592, 	-3.0436479060740274, 	-3.0416023636919474, 	
-3.0395360265272524, 	-3.0374489087070469, 	-3.0353410245005072, 	-3.0332123883187854, 	
-3.0310630147149102, 	-3.0288929183836872, 	-3.0267021141616, 	-3.0244906170267063, 	
-3.0222584420985377, 	-3.0200056046379946, 	-3.0177321200472438, 	-3.0154380038696114, 	
-3.0131232717894774, 	-3.0107879396321677, 	-3.0084320233638477, 	-3.006055539091411, 	
-3.003658503062371, 	-3.0012409316647477, 	-2.9988028414269587, 	-2.9963442490177035, 	
-2.9938651712458508, 	-2.9913656250603227, 	-2.9888456275499808, 	-2.986305195943507, 	
-2.9837443476092869, 	-2.9811631000552907, 	-2.978561470928955, 	-2.9759394780170587, 	
-2.9732971392456049, 	-2.9706344726796967, 	-2.9679514965234146, 	-2.9652482291196898, 	
-2.9625246889501824, 	-2.9597808946351511, 	-2.9570168649333293, 	-2.9542326187417944, 	
-2.9514281750958409, 	-2.9486035531688479, 	-2.945758772272149, 	-2.9428938518549006, 	
-2.9400088115039491, 	-2.9371036709436962, 	-2.9341784500359642, 	-2.931233168779861, 	
-2.9282678473116421, 	-2.9252825059045748, 	-2.9222771649687962, 	-2.9192518450511784, 	
-2.9162065668351844, 	-2.9131413511407271, 	-2.9100562189240291, 	-2.9069511912774773, 	
-2.9038262894294786, 	-2.9006815347443173, 	-2.8975169487220054, 	-2.8943325529981387, 	
-2.8911283693437477, 	-2.8879044196651478, 	-2.8846607260037915, 	-2.8813973105361161, 	
-2.8781141955733935, 	-2.8748114035615746, 	-2.8714889570811408, 	-2.8681468788469457, 	
-2.8647851917080605, 	-2.8614039186476186, 	-2.8580030827826586, 	-2.8545827073639649, 	
-2.8511428157759111, 	-2.8476834315362973, 	-2.8442045782961909, 	-2.8407062798397655, 	
-2.8371885600841362, 	-2.8336514430791988, 	-2.8300949530074626, 	-2.826519114183887, 	
-2.8229239510557149, 	-2.8193094882023053, 	-2.8156757503349645, 	-2.8120227622967784, 	
-2.8083505490624425, 	-2.804659135738091, 	-2.8009485475611244, 	-2.7972188099000368, 	
-2.7934699482542458, 	-2.7897019882539125, 	-2.7859149556597718, 	-2.7821088763629525, 	
-2.7782837763848014, 	-2.7744396818767068, 	-2.7705766191199181, 	-2.7666946145253655, 	
-2.7627936946334817, 	-2.758873886114019, 	-2.7549352157658671, 	-2.75097771051687, 	
-2.7470013974236407, 	-2.7430063036713799, 	-2.7389924565736852, 	-2.7349598835723685, 	
-2.7309086122372657, 	-2.7268386702660496, 	-2.7227500854840399, 	-2.7186428858440133, 	
-2.7145170994260122, 	-2.7103727544371532, 	-2.7062098792114337, 	-2.7020285022095374, 	
-2.6978286520186425, 	-2.6936103573522234, 	-2.6893736470498548, 	-2.6851185500770161, 	
-2.6808450955248921, 	-2.6765533126101744, 	-2.6722432306748627, 	-2.6679148791860605, 	
-2.6635682877357794, 	-2.6592034860407319, 	-2.6548205039421302, 	-2.6504193714054827, 	
-2.6460001185203881, 	-2.6415627755003297, 	-2.6371073726824692, 	-2.6326339405274402, 	
-2.6281425096191375, 	-2.6236331106645117, 	-2.6191057744933537, 	-2.6145605320580914, 	
-2.6099974144335705, 	-2.6054164528168475, 	-2.6008176785269734, 	-2.5962011230047817, 	
-2.5915668178126707, 	-2.5869147946343922, 	-2.5822450852748289, 	-2.5775577216597818, 	
-2.5728527358357507, 	-2.5681301599697131, 	-2.5633900263489071, 	-2.5586323673806093, 	
-2.5538572155919126, 	-2.5490646036295046, 	-2.5442545642594454, 	-2.539427130366942, 	
-2.5345823349561241, 	-2.5297202111498169, 	-2.5248407921893192, 	-2.5199441114341696, 	
-2.5150302023619249, 	-2.5100990985679266, 	-2.5051508337650725, 	-2.5001854417835871, 	
-2.4952029565707909, 	-2.4902034121908652, 	-2.4851868428246218, 	-2.4801532827692694, 	
-2.4751027664381775, 	-2.4700353283606424, 	-2.4649510031816506, 	-2.4598498256616432, 	
-2.4547318306762751, 	-2.4495970532161797, 	-2.4444455283867295, 	-2.4392772914077927, 	
-2.4340923776134979, 	-2.428890822451987, 	-2.4236726614851771, 	-2.4184379303885137, 	
-2.4131866649507314, 	-2.4079189010736042, 	-2.4026346747717033, 	-2.3973340221721497, 	
-2.3920169795143686, 	-2.3866835831498387, 	-2.3813338695418462, 	-2.3759678752652356, 	
-2.3705856370061582, 	-2.3651871915618212, 	-2.3597725758402386, 	-2.354341826859975, 	
-2.3488949817498965, 	-2.3434320777489139, 	-2.3379531522057291, 	-2.3324582425785811, 	
-2.3269473864349872, 	-2.3214206214514883, 	-2.3158779854133904, 	-2.3103195162145069, 	
-2.3047452518568985, 	-2.2991552304506149, 	-2.2935494902134321, 	-2.2879280694705932, 	
-2.2822910066545461, 	-2.2766383403046788, 	-2.2709701090670582, 	-2.265286351694165, 	
-2.2595871070446285, 	-2.2538724140829616, 	-2.2481423118792927, 	-2.2423968396091025, 	
-2.2366360365529498, 	-2.2308599420962105, 	-2.2250685957288026, 	-2.2192620370449174, 	
-2.2134403057427514, 	-2.2076034416242321, 	-2.2017514845947463, 	-2.1958844746628681, 	
-2.1900024519400869, 	-2.1841054566405278, 	-2.1781935290806835, 	-2.1722667096791333, 	
-2.1663250389562698, 	-2.1603685575340208, 	-2.154397306135571, 	-2.1484113255850845, 	
-2.142410656807427, 	-2.1363953408278817, 	-2.1303654187718744, 	-2.1243209318646872, 	
-2.1182619214311793, 	-2.1121884288955064, 	-2.1061004957808325, 	-2.0999981637090501, 	
-2.0938814744004937, 	-2.0877504696736557, 	-2.0816051914448996, 	-2.0754456817281741, 	
-2.0692719826347243, 	-2.0630841363728072, 	-2.0568821852473995, 	-2.0506661716599095, 	
-2.0444361381078879, 	-2.0381921271847383, 	-2.0319341815794223, 	-2.0256623440761716, 	
-2.0193766575541927, 	-2.0130771649873762, 	-2.0067639094440004, 	-2.0004369340864385, 	
-1.9940962821708632, 	-1.987741997046951, 	-1.9813741221575858, 	-1.9749927010385615, 	
-1.9685977773182843, 	-1.9621893947174764, 	-1.9557675970488737, 	-1.9493324282169284, 	
-1.9428839322175095, 	-1.9364221531375996, 	-1.9299471351549959, 	-1.923458922538007, 	
-1.9169575596451494, 	-1.9104430909248469, 	-1.903915560915123, 	-1.8973750142433008, 	
-1.8908214956256935, 	-1.8842550498673012, 	-1.877675721861505, 	-1.8710835565897581, 	
-1.86447859912128, 	-1.8578608946127475, 	-1.851230488307986, 	-1.84458742553766, 	
-1.8379317517189648, 	-1.8312635123553138, 	-1.8245827530360281, 	-1.8178895194360256, 	
-1.8111838573155081, 	-1.8044658125196489, 	-1.7977354309782774, 	-1.7909927587055687, 	
-1.7842378417997258, 	-1.7774707264426661, 	-1.7706914588997054, 	-1.7639000855192399, 	
-1.7570966527324332, 	-1.7502812070528941, 	-1.7434537950763631, 	-1.7366144634803902, 	
-1.7297632590240173, 	-1.7229002285474595, 	-1.7160254189717838, 	-1.7091388772985867, 	
-1.7022406506096768, 	-1.6953307860667488, 	-1.6884093309110644, 	-1.6814763324631261, 	
-1.6745318381223577, 	-1.6675758953667761, 	-1.6606085517526685, 	-1.6536298549142689, 	
-1.6466398525634296, 	-1.6396385924892967, 	-1.6326261225579823, 	-1.6256024907122386, 	
-1.6185677449711298, 	-1.6115219334297024, 	-1.6044651042586575, 	-1.5973973057040223, 	
-1.5903185860868185, 	-1.5832289938027331, 	-1.5761285773217866, 	-1.5690173851880032, 	
-1.5618954660190776, 	-1.554762868506042, 	-1.5476196414129353, 	-1.5404658335764685, 	
-1.5333014939056899, 	-1.5261266713816528, 	-1.5189414150570788, 	-1.5117457740560236, 	
-1.5045397975735399, 	-1.4973235348753435, 	-1.4900970352974729, 	-1.4828603482459553, 	
-1.4756135231964671, 	-1.4683566096939957, 	-1.4610896573525012, 	-1.4538127158545779, 	
-1.4465258349511125, 	-1.439229064460946, 	-1.4319224542705329, 	-1.4246060543335981, 	
-1.4172799146707988, 	-1.4099440853693788, 	-1.4025986165828292, 	-1.3952435585305436, 	
-1.3878789614974756, 	-1.3805048758337943, 	-1.3731213519545413, 	-1.3657284403392844, 	
-1.3583261915317741, 	-1.3509146561395964, 	-1.3434938848338291, 	-1.3360639283486921, 	
-1.3286248374812042, 	-1.3211766630908326, 	-1.3137194560991476, 	-1.3062532674894729, 	
-1.2987781483065375, 	-1.2912941496561274, 	-1.2838013227047351, 	-1.2762997186792104, 	
-1.2687893888664101, 	-1.2612703846128479, 	-1.2537427573243416, 	-1.2462065584656636, 	
-1.2386618395601885, 	-1.2311086521895402, 	-1.2235470479932398, 	-1.2159770786683521, 	
-1.2083987959691334, 	-1.2008122517066757, 	-1.1932174977485541, 	-1.1856145860184719, 	
-1.1780035684959045, 	-1.1703844972157456, 	-1.1627574242679501, 	-1.1551224017971793, 	
-1.1474794820024434, 	-1.1398287171367445, 	-1.1321701595067202, 	-1.1245038614722853, 	
-1.1168298754462747, 	-1.1091482538940836, 	-1.1014590493333098, 	-1.0937623143333952, 	
-1.0860581015152653, 	-1.0783464635509694, 	-1.0706274531633215, 	-1.062901123125539, 	
-1.0551675262608822, 	-1.0474267154422932, 	-1.0396787435920347, 	-1.0319236636813269, 	
-1.0241615287299872, 	-1.0163923918060664, 	-1.0086163060254865, 	-1.000833324551677, 	
-0.99304350059521196, 	-0.98524688741344635, 	-0.97744353831015085, 	-0.96963350663514869, 	
-0.96181684578395066, 	-0.95399360919738929, 	-0.94616385036125428, 	-0.93832762280592652, 	
-0.93048498010601188, 	-0.9226359758799757, 	-0.91478066378977529, 	-0.90691909754049371, 	
-0.89905133087997202, 	-0.89117741759844282, 	-0.8832974115281611, 	-0.87541136654303742, 	
-0.86751933655826885, 	-0.85962137552997075, 	-0.85171753745480772, 	-0.84380787636962462, 	
-0.83589244635107662, 	-0.82797130151526033, 	-0.82004449601734275, 	-0.81211208405119217, 	
-0.80417411984900666, 	-0.79623065768094425, 	-0.78828175185475058, 	-0.78032745671538939, 	
-0.7723678266446693, 	-0.76440291606087296, 	-0.7564327794183846, 	-0.74845747120731809, 	
-0.74047704595314423, 	-0.73249155821631773, 	-0.7245010625919045, 	-0.7165056137092084, 	
-0.70850526623139742, 	-0.70050007485513055, 	-0.69249009431018305, 	-0.6844753793590731, 	
-0.67645598479668678, 	-0.66843196544990369, 	-0.66040337617722211, 	-0.65237027186838381, 	
-0.64433270744399906, 	-0.6362907378551711, 	-0.62824441808311993, 	-0.62019380313880723, 	
-0.61213894806255942, 	-0.60407990792369215, 	-0.59601673782013354, 	-0.58794949287804688, 	
-0.57987822825145474, 	-0.57180299912186117, 	-0.56372386069787472, 	-0.55564086821483105, 	
-0.54755407693441505, 	-0.53946354214428327, 	-0.53136931915768582, 	-0.52327146331308805, 	
-0.51517002997379258, 	-0.50706507452756067, 	-0.49895665238623327, 	-0.49084481898535237, 	
-0.48272962978378214, 	-0.47461114026332968, 	-0.4664894059283653, 	-0.45836448230544391, 	
-0.45023642494292465, 	-0.4421052894105913, 	-0.43397113129927262, 	-0.4258340062204618, 	
-0.41769396980593682, 	-0.40955107770737975, 	-0.40140538559599653, 	-0.39325694916213566, 	
-0.38510582411490868, 	-0.37695206618180799, 	-0.36879573110832692, 	-0.36063687465757793, 	
-0.35247555260991159, 	-0.3443118207625353, 	-0.33614573492913169, 	-0.32797735093947716, 	
-0.31980672463906007, 	-0.31163391188869899, 	-0.3034589685641606, 	-0.29528195055577827, 	
-0.28710291376806912, 	-0.27892191411935241, 	-0.27073900754136715, 	-0.26255424997888938, 	
-0.25436769738935017, 	-0.24617940574245262, 	-0.23798943101978953, 	-0.22979782921446043, 	
-0.22160465633068893, 	-0.21340996838343967, 	-0.20521382139803554, 	-0.19701627140977457, 	
-0.18881737446354679, 	-0.18061718661345108, 	-0.17241576392241195, 	-0.16421316246179629, 	
-0.15600943831102995, 	-0.14780464755721437, 	-0.13959884629474317, 	-0.13139209062491858, 	
-0.12318443665556783, 	-0.11497594050065975, 	-0.10676665827992093, 	-0.098556646118452218, 	
-0.090345960146344786, 	-0.082134656498296585, 	-0.073922791313228486, 	-0.065710420733900418, 	
-0.057497600906527606, 	-0.049284387980396714, 	-0.041070838107481911, 	-0.032857007442061006, 	
-0.02464295214033151, 	-0.016428728360026745, 	-0.0082143922600318876, 	-1.1616935740061835e-31, 	
0.0082143922600318876, 	0.016428728360026745, 	0.02464295214033151, 	0.032857007442061006, 	
0.041070838107481911, 	0.049284387980396714, 	0.057497600906527606, 	0.065710420733900418, 	
0.073922791313228486, 	0.082134656498296585, 	0.090345960146344786, 	0.098556646118452218, 	
0.10676665827992093, 	0.11497594050065975, 	0.12318443665556783, 	0.13139209062491858, 	
0.13959884629474317, 	0.14780464755721437, 	0.15600943831102995, 	0.16421316246179629, 	
0.17241576392241195, 	0.18061718661345108, 	0.18881737446354679, 	0.19701627140977457, 	
0.20521382139803554, 	0.21340996838343967, 	0.22160465633068893, 	0.22979782921446043, 	
0.23798943101978953, 	0.24617940574245262, 	0.25436769738935017, 	0.26255424997888938, 	
0.27073900754136715, 	0.27892191411935241, 	0.28710291376806912, 	0.29528195055577827, 	
0.3034589685641606, 	0.31163391188869899, 	0.31980672463906007, 	0.32797735093947716, 	
0.33614573492913169, 	0.3443118207625353, 	0.35247555260991159, 	0.36063687465757793, 	
0.36879573110832692, 	0.37695206618180799, 	0.38510582411490868, 	0.39325694916213566, 	
0.40140538559599653, 	0.40955107770737975, 	0.41769396980593682, 	0.4258340062204618, 	
0.43397113129927262, 	0.4421052894105913, 	0.45023642494292465, 	0.45836448230544391, 	
0.4664894059283653, 	0.47461114026332968, 	0.48272962978378214, 	0.49084481898535237, 	
0.49895665238623327, 	0.50706507452756067, 	0.51517002997379258, 	0.52327146331308805, 	
0.53136931915768582, 	0.53946354214428327, 	0.54755407693441505, 	0.55564086821483105, 	
0.56372386069787472, 	0.57180299912186117, 	0.57987822825145474, 	0.58794949287804688, 	
0.59601673782013354, 	0.60407990792369215, 	0.61213894806255942, 	0.62019380313880723, 	
0.62824441808311993, 	0.6362907378551711, 	0.64433270744399906, 	0.65237027186838381, 	
0.66040337617722211, 	0.66843196544990369, 	0.67645598479668678, 	0.6844753793590731, 	
0.69249009431018305, 	0.70050007485513055, 	0.70850526623139742, 	0.7165056137092084, 	
0.7245010625919045, 	0.73249155821631773, 	0.74047704595314423, 	0.74845747120731809, 	
0.7564327794183846, 	0.76440291606087296, 	0.7723678266446693, 	0.78032745671538939, 	
0.78828175185475058, 	0.79623065768094425, 	0.80417411984900666, 	0.81211208405119217, 	
0.82004449601734275, 	0.82797130151526033, 	0.83589244635107662, 	0.84380787636962462, 	
0.85171753745480772, 	0.85962137552997075, 	0.86751933655826885, 	0.87541136654303742, 	
0.8832974115281611, 	0.89117741759844282, 	0.89905133087997202, 	0.90691909754049371, 	
0.91478066378977529, 	0.9226359758799757, 	0.93048498010601188, 	0.93832762280592652, 	
0.94616385036125428, 	0.95399360919738929, 	0.96181684578395066, 	0.96963350663514869, 	
0.97744353831015085, 	0.98524688741344635, 	0.99304350059521196, 	1.000833324551677, 	
1.0086163060254865, 	1.0163923918060664, 	1.0241615287299872, 	1.0319236636813269, 	
1.0396787435920347, 	1.0474267154422932, 	1.0551675262608822, 	1.062901123125539, 	
1.0706274531633215, 	1.0783464635509694, 	1.0860581015152653, 	1.0937623143333952, 	
1.1014590493333098, 	1.1091482538940836, 	1.1168298754462747, 	1.1245038614722853, 	
1.1321701595067202, 	1.1398287171367445, 	1.1474794820024434, 	1.1551224017971793, 	
1.1627574242679501, 	1.1703844972157456, 	1.1780035684959045, 	1.1856145860184719, 	
1.1932174977485541, 	1.2008122517066757, 	1.2083987959691334, 	1.2159770786683521, 	
1.2235470479932398, 	1.2311086521895402, 	1.2386618395601885, 	1.2462065584656636, 	
1.2537427573243416, 	1.2612703846128479, 	1.2687893888664101, 	1.2762997186792104, 	
1.2838013227047351, 	1.2912941496561274, 	1.2987781483065375, 	1.3062532674894729, 	
1.3137194560991476, 	1.3211766630908326, 	1.3286248374812042, 	1.3360639283486921, 	
1.3434938848338291, 	1.3509146561395964, 	1.3583261915317741, 	1.3657284403392844, 	
1.3731213519545413, 	1.3805048758337943, 	1.3878789614974756, 	1.3952435585305436, 	
1.4025986165828292, 	1.4099440853693788, 	1.4172799146707988, 	1.4246060543335981, 	
1.4319224542705329, 	1.439229064460946, 	1.4465258349511125, 	1.4538127158545779, 	
1.4610896573525012, 	1.4683566096939957, 	1.4756135231964671, 	1.4828603482459553, 	
1.4900970352974729, 	1.4973235348753435, 	1.5045397975735399, 	1.5117457740560236, 	
1.5189414150570788, 	1.5261266713816528, 	1.5333014939056899, 	1.5404658335764685, 	
1.5476196414129353, 	1.554762868506042, 	1.5618954660190776, 	1.5690173851880032, 	
1.5761285773217866, 	1.5832289938027331, 	1.5903185860868185, 	1.5973973057040223, 	
1.6044651042586575, 	1.6115219334297024, 	1.6185677449711298, 	1.6256024907122386, 	
1.6326261225579823, 	1.6396385924892967, 	1.6466398525634296, 	1.6536298549142689, 	
1.6606085517526685, 	1.6675758953667761, 	1.6745318381223577, 	1.6814763324631261, 	
1.6884093309110644, 	1.6953307860667488, 	1.7022406506096768, 	1.7091388772985867, 	
1.7160254189717838, 	1.7229002285474595, 	1.7297632590240173, 	1.7366144634803902, 	
1.7434537950763631, 	1.7502812070528941, 	1.7570966527324332, 	1.7639000855192399, 	
1.7706914588997054, 	1.7774707264426661, 	1.7842378417997258, 	1.7909927587055687, 	
1.7977354309782774, 	1.8044658125196489, 	1.8111838573155081, 	1.8178895194360256, 	
1.8245827530360281, 	1.8312635123553138, 	1.8379317517189648, 	1.84458742553766, 	
1.851230488307986, 	1.8578608946127475, 	1.86447859912128, 	1.8710835565897581, 	
1.877675721861505, 	1.8842550498673012, 	1.8908214956256935, 	1.8973750142433008, 	
1.903915560915123, 	1.9104430909248469, 	1.9169575596451494, 	1.923458922538007, 	
1.9299471351549959, 	1.9364221531375996, 	1.9428839322175095, 	1.9493324282169284, 	
1.9557675970488737, 	1.9621893947174764, 	1.9685977773182843, 	1.9749927010385615, 	
1.9813741221575858, 	1.987741997046951, 	1.9940962821708632, 	2.0004369340864385, 	
2.0067639094440004, 	2.0130771649873762, 	2.0193766575541927, 	2.0256623440761716, 	
2.0319341815794223, 	2.0381921271847383, 	2.0444361381078879, 	2.0506661716599095, 	
2.0568821852473995, 	2.0630841363728072, 	2.0692719826347243, 	2.0754456817281741, 	
2.0816051914448996, 	2.0877504696736557, 	2.0938814744004937, 	2.0999981637090501, 	
2.1061004957808325, 	2.1121884288955064, 	2.1182619214311793, 	2.1243209318646872, 	
2.1303654187718744, 	2.1363953408278817, 	2.142410656807427, 	2.1484113255850845, 	
2.154397306135571, 	2.1603685575340208, 	2.1663250389562698, 	2.1722667096791333, 	
2.1781935290806835, 	2.1841054566405278, 	2.1900024519400869, 	2.1958844746628681, 	
2.2017514845947463, 	2.2076034416242321, 	2.2134403057427514, 	2.2192620370449174, 	
2.2250685957288026, 	2.2308599420962105, 	2.2366360365529498, 	2.2423968396091025, 	
2.2481423118792927, 	2.2538724140829616, 	2.2595871070446285, 	2.265286351694165, 	
2.2709701090670582, 	2.2766383403046788, 	2.2822910066545461, 	2.2879280694705932, 	
2.2935494902134321, 	2.2991552304506149, 	2.3047452518568985, 	2.3103195162145069, 	
2.3158779854133904, 	2.3214206214514883, 	2.3269473864349872, 	2.3324582425785811, 	
2.3379531522057291, 	2.3434320777489139, 	2.3488949817498965, 	2.354341826859975, 	
2.3597725758402386, 	2.3651871915618212, 	2.3705856370061582, 	2.3759678752652356, 	
2.3813338695418462, 	2.3866835831498387, 	2.3920169795143686, 	2.3973340221721497, 	
2.4026346747717033, 	2.4079189010736042, 	2.4131866649507314, 	2.4184379303885137, 	
2.4236726614851771, 	2.428890822451987, 	2.4340923776134979, 	2.4392772914077927, 	
2.4444455283867295, 	2.4495970532161797, 	2.4547318306762751, 	2.4598498256616432, 	
2.4649510031816506, 	2.4700353283606424, 	2.4751027664381775, 	2.4801532827692694, 	
2.4851868428246218, 	2.4902034121908652, 	2.4952029565707909, 	2.5001854417835871, 	
2.5051508337650725, 	2.5100990985679266, 	2.5150302023619249, 	2.5199441114341696, 	
2.5248407921893192, 	2.5297202111498169, 	2.5345823349561241, 	2.539427130366942, 	
2.5442545642594454, 	2.5490646036295046, 	2.5538572155919126, 	2.5586323673806093, 	
2.5633900263489071, 	2.5681301599697131, 	2.5728527358357507, 	2.5775577216597818, 	
2.5822450852748289, 	2.5869147946343922, 	2.5915668178126707, 	2.5962011230047817, 	
2.6008176785269734, 	2.6054164528168475, 	2.6099974144335705, 	2.6145605320580914, 	
2.6191057744933537, 	2.6236331106645117, 	2.6281425096191375, 	2.6326339405274402, 	
2.6371073726824692, 	2.6415627755003297, 	2.6460001185203881, 	2.6504193714054827, 	
2.6548205039421302, 	2.6592034860407319, 	2.6635682877357794, 	2.6679148791860605, 	
2.6722432306748627, 	2.6765533126101744, 	2.6808450955248921, 	2.6851185500770161, 	
2.6893736470498548, 	2.6936103573522234, 	2.6978286520186425, 	2.7020285022095374, 	
2.7062098792114337, 	2.7103727544371532, 	2.7145170994260122, 	2.7186428858440133, 	
2.7227500854840399, 	2.7268386702660496, 	2.7309086122372657, 	2.7349598835723685, 	
2.7389924565736852, 	2.7430063036713799, 	2.7470013974236407, 	2.75097771051687, 	
2.7549352157658671, 	2.758873886114019, 	2.7627936946334817, 	2.7666946145253655, 	
2.7705766191199181, 	2.7744396818767068, 	2.7782837763848014, 	2.7821088763629525, 	
2.7859149556597718, 	2.7897019882539125, 	2.7934699482542458, 	2.7972188099000368, 	
2.8009485475611244, 	2.804659135738091, 	2.8083505490624425, 	2.8120227622967784, 	
2.8156757503349645, 	2.8193094882023053, 	2.8229239510557149, 	2.826519114183887, 	
2.8300949530074626, 	2.8336514430791988, 	2.8371885600841362, 	2.8407062798397655, 	
2.8442045782961909, 	2.8476834315362973, 	2.8511428157759111, 	2.8545827073639649, 	
2.8580030827826586, 	2.8614039186476186, 	2.8647851917080605, 	2.8681468788469457, 	
2.8714889570811408, 	2.8748114035615746, 	2.8781141955733935, 	2.8813973105361161, 	
2.8846607260037915, 	2.8879044196651478, 	2.8911283693437477, 	2.8943325529981387, 	
2.8975169487220054, 	2.9006815347443173, 	2.9038262894294786, 	2.9069511912774773, 	
2.9100562189240291, 	2.9131413511407271, 	2.9162065668351844, 	2.9192518450511784, 	
2.9222771649687962, 	2.9252825059045748, 	2.9282678473116421, 	2.931233168779861, 	
2.9341784500359642, 	2.9371036709436962, 	2.9400088115039491, 	2.9428938518549006, 	
2.945758772272149, 	2.9486035531688479, 	2.9514281750958409, 	2.9542326187417944, 	
2.9570168649333293, 	2.9597808946351511, 	2.9625246889501824, 	2.9652482291196898, 	
2.9679514965234146, 	2.9706344726796967, 	2.9732971392456049, 	2.9759394780170587, 	
2.978561470928955, 	2.9811631000552907, 	2.9837443476092869, 	2.986305195943507, 	
2.9888456275499808, 	2.9913656250603227, 	2.9938651712458508, 	2.9963442490177035, 	
2.9988028414269587, 	3.0012409316647477, 	3.003658503062371, 	3.006055539091411, 	
3.0084320233638477, 	3.0107879396321677, 	3.0131232717894774, 	3.0154380038696114, 	
3.0177321200472438, 	3.0200056046379946, 	3.0222584420985377, 	3.0244906170267063, 	
3.0267021141616, 	3.0288929183836872, 	3.0310630147149102, 	3.0332123883187854, 	
3.0353410245005072, 	3.0374489087070469, 	3.0395360265272524, 	3.0416023636919474, 	
3.0436479060740274, 	3.0456726396885592, 	3.0476765506928731, 	3.0496596253866599, 	
3.0516218502120633, 	3.0535632117537737, 	3.0554836967391181, 	3.0573832920381538, 	
3.0592619846637552, 	3.0611197617717041, 	3.0629566106607768, 	3.0647725187728323, 	
3.0665674736928961, 	3.0683414631492472, 	3.0700944750134997, 	3.0718264973006884, 	
3.0735375181693492, 	3.0752275259215986, 	3.076896509003217, 	3.0785444560037258, 	
3.0801713556564643, 	3.0817771968386696, 	3.0833619685715496, 	3.0849256600203612, 	
3.0864682604944806, 	3.0879897594474808, 	3.0894901464771993, 	3.0909694113258124, 	
3.092427543879904, 	3.0938645341705353, 	3.095280372373312, 	3.0966750488084527, 	
3.098048553940854, 	3.0994008783801568, 	3.1007320128808096, 	3.1020419483421309, 	
3.1033306758083743, 	3.1045981864687877, 	3.1058444716576723, 	3.1070695228544443, 	
3.108273331683693, 	3.1094558899152358, 	3.1106171894641768, 	3.1117572223909611, 	
3.1128759809014293, 	3.1139734573468698, 	3.1150496442240736, 	3.116104534175383, 	
3.1171381199887427, 	3.1181503945977505, 	3.1191413510817032, 	3.1201109826656457, 	
3.1210592827204175, 	3.1219862447626965, 	3.1228918624550452, 	3.1237761296059521, 	
3.124639040169876, 	3.125480588247286, 	3.126300768084703, 	3.1270995740747383, 	
3.1278770007561314, 	3.1286330428137896, 	3.1293676950788232, 	3.1300809525285795, 	
3.1307728102866803, 	3.131443263623054, 	3.1320923079539678, 	3.1327199388420603, 	
3.1333261519963713, 	3.1339109432723737, 	3.1344743086720008, 	3.1350162443436753, 	
3.1355367465823365, 	3.1360358118294696, 	3.1365134366731282, 	3.1369696178479658, 	
3.1374043522352588, 	3.1378176368629358, 	3.1382094689056048, 	3.1385798456845868, 	
3.1389287646679489, 	3.1392562234705501, 	3.1395622198540978, 	3.1398467517272239, 	
3.1401098171456012, 	3.1403514143121267, 	3.1405715415772302, 	3.1407701974394291, 	
3.1409473805463977, 	3.1411030896971908, 	3.1412373238473208, 	3.141350082121801, 	
3.1414413638543479, 	3.1415111687348847, 	3.1415594976010106, 	3.141586360856659, 	
};

std::vector<double> Numerics::gaulegW = {
1.6149179940346393e-05, 	3.7592109765625085e-05, 	5.9066533928031779e-05, 	8.0543312094775782e-05, 	0.00010202009328478848, 	
0.0001234963428279235, 	0.00014497181107403148, 	0.00016644631624473228, 	0.00018791969745967152, 	
0.00020939180151676267, 	0.00023086247842665775, 	0.00025233157968739244, 	0.00027379895754508214, 	
0.00029526446464949314, 	0.00031672795388284418, 	0.00033818927827010799, 	0.00035964829092947545, 	
0.0003811048450443071, 	0.00040255879384666393, 	0.0004240099906079187, 	0.00044545828863260884, 	
0.00046690354125506953, 	0.00048834560183771427, 	0.00050978432376967882, 	0.0005312195604667148, 	
0.00055265116537139478, 	0.00057407899195271333, 	0.00059550289370737723, 	0.00061692272416004085, 	
0.00063833833686414781, 	0.00065974958540259505, 	0.00068115632338894532, 	0.00070255840446736329, 	
0.00072395568231512332, 	0.00074534801064203755, 	0.00076673524319226271, 	0.0007881172337447799, 	
0.00080949383611465234, 	0.00083086490415387911, 	0.00085223029175255944, 	0.0008735898528395013, 	
0.00089494344138355681, 	0.00091629091139430296, 	0.00093763211692353833, 	0.00095896691206567928, 	
0.00098029515095885236, 	0.0010016166877864594, 	0.001022931376777472, 	0.0010442390722076719, 	
0.0010655396284009416, 	0.0010868328997296133, 	0.0011081187406161842, 	0.001129397005533802, 	
0.0011506675490073307, 	0.001171930225614732, 	0.0011931848899874096, 	0.0012144313968117009, 	
0.0012356696008299351, 	0.0012568993568408768, 	0.0012781205197012464, 	0.0012993329443262681, 	
0.001320536485691369, 	0.0013417309988323052, 	0.001362916338846781, 	0.0013840923608951269, 	
0.001405258920201322, 	0.0014264158720541807, 	0.0014475630718081003, 	0.0014687003748842628, 	
0.0014898276367714687, 	0.0015109447130269441, 	0.001532051459278001, 	0.0015531477312221845, 	
0.0015742333846288504, 	0.00159530827533985, 	0.0016163722592706289, 	0.0016374251924114569, 	
0.0016584669308277354, 	0.0016794973306616546, 	0.0017005162481328418, 	0.0017215235395395582, 	
0.0017425190612593913, 	0.0017635026697504575, 	0.0017844742215522974, 	0.0018054335732869879, 	
0.0018263805816598753, 	0.0018473151034606957, 	0.0018682369955647334, 	0.0018891461149334395, 	
0.0019100423186156536, 	0.0019309254637485196, 	0.0019517954075583734, 	0.0019726520073620009, 	
0.0019934951205672065, 	0.0020143246046742348, 	0.0020351403172761419, 	0.0020559421160606323, 	
0.0020767298588101001, 	0.002097503403403251, 	0.0021182626078157878, 	0.002139007330121461, 	
0.0021597374284931122, 	0.0021804527612035844, 	0.0022011531866263688, 	0.0022218385632373598, 	
0.0022425087496148362, 	0.0022631636044413367, 	0.002283802986503988, 	0.0023044267546957621, 	
0.0023250347680163399, 	0.0023456268855733043, 	0.0023662029665825132, 	0.002386762870369959, 	
0.0024073064563718506, 	0.0024278335841362033, 	0.0024483441133233679, 	0.0024688379037072741, 	
0.0024893148151762185, 	0.0025097747077340604, 	0.0025302174415008159, 	0.0025506428767139884, 	
0.0025710508737291911, 	0.0025914412930213757, 	0.0026118139951855756, 	0.0026321688409379311, 	
0.002652505691116901, 	0.0026728244066836927, 	0.002693124848723626, 	0.0027134068784469608, 	
0.0027336703571897852, 	0.0027539151464150307, 	0.0027741411077134531, 	0.0027943481028044441, 	
0.0028145359935371874, 	0.0028347046418913742, 	0.0028548539099782833, 	0.0028749836600415993, 	
0.0028950937544587204, 	0.002915184055741107, 	0.0029352544265357655, 	0.0029553047296258014, 	
0.0029753348279316061, 	0.0029953445845118235, 	0.0030153338625638474, 	0.003035302525425432, 	
0.0030552504365750151, 	0.0030751774596330826, 	0.0030950834583627252, 	0.0031149682966710745, 	
0.003134831838609623, 	0.0031546739483757158, 	0.0031744944903129711, 	0.0031942933289127182, 	
0.003214070328814433, 	0.0032338253548070766, 	0.0032535582718298153, 	0.0032732689449728497, 	
0.0032929572394786275, 	0.0033126230207423763, 	0.0033322661543135701, 	0.0033518865058960569, 	
0.0033714839413498598, 	0.0033910583266915559, 	0.0034106095280952036, 	0.0034301374118934258, 	
0.0034496418445783233, 	0.0034691226928022156, 	0.003488579823378698, 	0.0035080131032836806, 	
0.0035274223996559057, 	0.0035468075797982349, 	0.0035661685111782293, 	0.0035855050614294419, 	
0.0036048170983520606, 	0.0036241044899138295, 	0.0036433671042508269, 	0.0036626048096689281, 	
0.0036818174746439045, 	0.0037010049678229862, 	0.0037201671580254915, 	0.0037393039142432603, 	
0.0037584151056427508, 	0.0037775006015647243, 	0.0037965602715258058, 	0.003815593985219007, 	
0.0038346016125150365, 	0.0038535830234627932, 	0.0038725380882904132, 	0.0038914666774061799, 	
0.0039103686613993502, 	0.0039292439110412049, 	0.0039480922972856946, 	0.0039669136912704409, 	
0.0039857079643176177, 	0.004004474987934761, 	0.0040232146338158399, 	0.0040419267738418278, 	
0.0040606112800818783, 	0.0040792680247940293, 	0.0040978968804261801, 	0.0041164977196167804, 	
0.0041350704151958415, 	0.0041536148401859754, 	0.0041721308678027971, 	0.0041906183714562522, 	
0.0042090772247512153, 	0.0042275073014885018, 	0.0042459084756655743, 	0.0042642806214775826, 	
0.0042826236133181751, 	0.0043009373257801905, 	0.0043192216336567432, 	0.0043374764119419248, 	
0.0043557015358316143, 	0.0043738968807247244, 	0.0043920623222235841, 	0.0044101977361348382, 	
0.0044283029984706502, 	0.0044463779854491646, 	0.0044644225734956893, 	0.0044824366392431335, 	
0.0045004200595331828, 	0.0045183727114171358, 	0.0045362944721565298, 	0.0045541852192241385, 	
0.0045720448303047685, 	0.0045898731832960653, 	0.004607670156309444, 	0.0046254356276707988, 	
0.0046431694759214402, 	0.00466087157981869, 	0.0046785418183373463, 	0.0046961800706695079, 	
0.0047137862162264614, 	0.0047313601346385906, 	0.0047489017057568989, 	0.0047664108096533786, 	
0.0047838873266220329, 	0.0048013311371796728, 	0.0048187421220667595, 	0.0048361201622480693, 	
0.004853465138913657, 	0.0048707769334797504, 	0.0048880554275892059, 	0.0049053005031126848, 	
0.004922512042149386, 	0.0049396899270276245, 	0.0049568340403058865, 	0.0049739442647735981, 	
0.0049910204834517878, 	0.0050080625795941008, 	0.0050250704366872709, 	0.0050420439384522894, 	
0.0050589829688449522, 	0.0050758874120567293, 	0.0050927571525155365, 	0.0051095920748866512, 	
0.0051263920640733669, 	0.0051431570052176091, 	0.0051598867837012452, 	0.0051765812851462941, 	
0.0051932403954159517, 	0.005209864000615465, 	0.0052264519870929187, 	0.0052430042414397787, 	
0.0052595206504919365, 	0.0052760011013300223, 	0.0052924454812808205, 	0.0053088536779176436, 	
0.0053252255790612393, 	0.005341561072780312, 	0.0053578600473927086, 	0.00537412239146569, 	
0.0053903479938173212, 	0.0054065367435164741, 	0.0054226885298841922, 	0.0054388032424941774, 	
0.0054548807711735994, 	0.005470921006003846, 	0.0054869238373212214, 	0.0055028891557178158, 	
0.0055188168520422876, 	0.0055347068174002511, 	0.0055505589431555187, 	0.0055663731209305107, 	
0.0055821492426069447, 	0.0055978872003270026, 	0.0056135868864936401, 	0.005629248193771432, 	
0.0056448710150873794, 	0.0056604552436316843, 	0.00567600077285814, 	0.0056915074964855438, 	
0.0057069753084975404, 	0.0057224041031440822, 	0.0057377937749418882, 	0.0057531442186749644, 	
0.0057684553293956995, 	0.0057837270024253306, 	0.0057989591333546349, 	0.0058141516180448107, 	
0.0058293043526281597, 	0.0058444172335086779, 	0.0058594901573627177, 	0.0058745230211400953, 	
0.0058895157220642909, 	0.0059044681576334032, 	0.0059193802256208884, 	0.0059342518240760164, 	
0.0059490828513250578, 	0.0059638732059712745, 	0.0059786227868962689, 	0.005993331493260352, 	
0.006007999224503179, 	0.0060226258803446646, 	0.0060372113607855132, 	0.0060517555661079268, 	
0.0060662583968762234, 	0.0060807197539377101, 	0.0060951395384233418, 	0.006109517651747799, 	
0.0061238539956113046, 	0.0061381484719993063, 	0.0061524009831834077, 	0.0061666114317223027, 	
0.0061807797204623529, 	0.0061949057525377835, 	0.0062089894313720985, 	0.0062230306606780601, 	
0.0062370293444589863, 	0.0062509853870087511, 	0.006264898692912883, 	0.0062787691670492148, 	
0.0062925967145881379, 	0.0063063812409938072, 	0.0063201226520243235, 	0.006333820853732566, 	
0.0063474757524669499, 	0.0063610872548717631, 	0.0063746552678880892, 	0.0063881796987544821, 	
0.0064016604550072671, 	0.0064150974444811965, 	0.0064284905753106969, 	0.0064418397559297619, 	
0.0064551448950728105, 	0.0064684059017755084, 	0.0064816226853752577, 	0.0064947951555116993, 	
0.0065079232221275096, 	0.0065210067954688212, 	0.0065340457860862391, 	0.0065470401048346918, 	
0.0065599896628750504, 	0.0065728943716739027, 	0.0065857541430045102, 	0.0065985688889474035, 	
0.0066113385218908756, 	0.0066240629545316872, 	0.0066367420998756331, 	0.0066493758712381562, 	
0.0066619641822448176, 	0.0066745069468320825, 	0.0066870040792477445, 	0.0066994554940515861, 	
0.006711861106115922, 	0.0067242208306263242, 	0.0067365345830819557, 	0.0067488022792963186, 	
0.0067610238353977975, 	0.0067731991678302789, 	0.0067853281933536709, 	0.0067974108290443707, 	
0.0068094469922959436, 	0.0068214366008197864, 	0.006833379572645553, 	0.0068452758261216646, 	
0.006857125279915886, 	0.0068689278530162656, 	0.0068806834647309337, 	0.006892392034689456, 	
0.0069040534828427452, 	0.0069156677294640893, 	0.0069272346951491917, 	0.0069387543008174206, 	
0.0069502264677115374, 	0.0069616511173988278, 	0.0069730281717714651, 	0.0069843575530469876, 	
0.0069956391837687334, 	0.0070068729868066719, 	0.0070180588853577235, 	0.0070291968029463541, 	
0.0070402866634249059, 	0.0070513283909744507, 	0.0070623219101049912, 	0.007073267145656285, 	
0.0070841640227980538, 	0.0070950124670307061, 	0.0071058124041857296, 	0.0071165637604263358, 	
0.0071272664622477168, 	0.0071379204364778711, 	0.0071485256102778528, 	0.0071590819111423494, 	
0.007169589266900203, 	0.0071800476057148847, 	0.0071904568560848918, 	0.0072008169468445217, 	
0.0072111278071640581, 	0.0072213893665502753, 	0.0072316015548472262, 	0.0072417643022362381, 	
0.0072518775392368022, 	0.007261941196706985, 	0.0072719552058436252, 	0.0072819194981831323, 	
0.007291834005601714, 	0.0073016986603161626, 	0.0073115133948838344, 	0.0073212781422035376, 	
0.0073309928355157292, 	0.0073406574084031988, 	0.0073502717947913215, 	0.0073598359289485209, 	
0.0073693497454869689, 	0.0073788131793627552, 	0.0073882261658763815, 	0.0073975886406732246, 	
0.0074069005397440204, 	0.0074161617994255198, 	0.007425372356400315, 	0.0074345321476977713, 	
0.0074436411106944675, 	0.0074526991831143693, 	0.007461706303029318, 	0.00747066240885964, 	
0.0074795674393741945, 	0.0074884213336914611, 	0.0074972240312790569, 	0.0075059754719549437, 	
0.0075146755958873292, 	0.007523324343595309, 	0.0075319216559492789, 	0.007540467474171423, 	
0.0075489617398355763, 	0.0075574043948683379, 	0.0075657953815492203, 	0.0075741346425106677, 	
0.0075824221207390213, 	0.0075906577595745185, 	0.0075988415027119904, 	0.0076069732942008611, 	
0.0076150530784457916, 	0.0076230808002070334, 	0.0076310564046008639, 	0.007638979837099674, 	
0.007646851043532691, 	0.0076546699700862286, 	0.0076624365633038982, 	0.0076701507700872125, 	
0.0076778125376956762, 	0.0076854218137475836, 	0.0076929785462199517, 	0.0077004826834488659, 	
0.0077079341741303087, 	0.0077153329673199152, 	0.0077226790124337802, 	0.0077299722592485661, 	
0.0077372126579019667, 	0.0077444001588928236, 	0.0077515347130817534, 	0.007758616271691398, 	
0.0077656447863067172, 	0.0077726202088750822, 	0.0077795424917071771, 	0.0077864115874767504, 	
0.0077932274492213639, 	0.0077999900303423325, 	0.007806699284605422, 	0.0078133551661407966, 	
0.0078199576294437322, 	0.0078265066293745859, 	0.0078330021211592184, 	0.0078394440603893507, 	
0.007845832403022791, 	0.0078521671053839327, 	0.0078584481241635844, 	0.0078646754164200163, 	
0.007870848939578361, 	0.0078769686514315752, 	0.0078830345101406057, 	0.007889046474234454, 	
0.0078950045026105684, 	0.007900908554535244, 	0.0079067585896437191, 	0.0079125545679405371, 	
0.0079182964497998016, 	0.0079239841959655583, 	0.0079296177675519178, 	0.0079351971260433994, 	
0.0079407222332950524, 	0.0079461930515328308, 	0.0079516095433540979, 	0.0079569716717273475, 	
0.0079622793999929442, 	0.0079675326918628945, 	0.0079727315114218236, 	0.0079778758231264235, 	
0.007982965591806012, 	0.0079880007826631169, 	0.0079929813612731482, 	0.007997907293584931, 	
0.0080027785459209008, 	0.008007595084977422, 	0.0080123568778248857, 	0.00801706389190774, 	
0.0080217160950453795, 	0.0080263134554315035, 	0.0080308559416351257, 	0.0080353435226000781, 	
0.0080397761676458471, 	0.0080441538464672592, 	0.0080484765291351582, 	0.0080527441860962761, 	
0.0080569567881736918, 	0.0080611143065664956, 	0.0080652167128506935, 	0.0080692639789791271, 	
0.0080732560772815275, 	0.0080771929804645884, 	0.0080810746616127131, 	0.0080849010941875955, 	
0.0080886722520287554, 	0.008092388109353579, 	0.0080960486407575648, 	0.0080996538212144819, 	
0.0081032036260764856, 	0.0081066980310742724, 	0.0081101370123173536, 	0.0081135205462941149, 	
0.0081168486098721869, 	0.0081201211802982131, 	0.0081233382351982974, 	0.0081264997525782399, 	
0.0081296057108233982, 	0.0081326560886989061, 	0.0081356508653500793, 	0.0081385900203022402, 	
0.0081414735334609818, 	0.0081443013851124381, 	0.0081470735559231056, 	0.0081497900269402526, 	
0.0081524507795920666, 	0.0081550557956873403, 	0.0081576050574164172, 	0.0081600985473502564, 	
0.0081625362484415414, 	0.0081649181440242562, 	0.0081672442178137919, 	0.0081695144539074612, 	
0.0081717288367839681, 	0.0081738873513041137, 	0.0081759899827106332, 	0.0081780367166282304, 	
0.0081800275390638694, 	0.0081819624364066808, 	0.0081838413954281597, 	0.0081856644032823767, 	
0.008187431447505748, 	0.0081891425160174527, 	0.008190797597119083, 	0.0081923966794954211, 	
0.0081939397522137365, 	0.0081954268047244941, 	0.008196857826860993, 	0.0081982328088395697, 	
0.0081995517412597734, 	0.0082008146151044611, 	0.008202021421739588, 	0.0082031721529143391, 	
0.0082042668007616497, 	0.0082053053577974509, 	0.0082062878169214884, 	0.0082072141714168399, 	
0.008208084414950181, 	0.0082088985415718074, 	0.0082096565457158363, 	0.0082103584221999686, 	
0.008211004166225536, 	0.0082115937733777018, 	0.0082121272396254406, 	0.0082126045613217062, 	
0.0082130257352030622, 	0.0082133907583899473, 	0.0082136996283869498, 	0.0082139523430822346, 	
0.0082141489007480986, 	0.0082142893000407592, 	0.0082143735400003123, 	0.0082144016200508645, 	
0.0082143735400003123, 	0.0082142893000407592, 	0.0082141489007480986, 	0.0082139523430822346, 	
0.0082136996283869498, 	0.0082133907583899473, 	0.0082130257352030622, 	0.0082126045613217062, 	
0.0082121272396254406, 	0.0082115937733777018, 	0.008211004166225536, 	0.0082103584221999686, 	
0.0082096565457158363, 	0.0082088985415718074, 	0.008208084414950181, 	0.0082072141714168399, 	
0.0082062878169214884, 	0.0082053053577974509, 	0.0082042668007616497, 	0.0082031721529143391, 	
0.008202021421739588, 	0.0082008146151044611, 	0.0081995517412597734, 	0.0081982328088395697, 	
0.008196857826860993, 	0.0081954268047244941, 	0.0081939397522137365, 	0.0081923966794954211, 	
0.008190797597119083, 	0.0081891425160174527, 	0.008187431447505748, 	0.0081856644032823767, 	
0.0081838413954281597, 	0.0081819624364066808, 	0.0081800275390638694, 	0.0081780367166282304, 	
0.0081759899827106332, 	0.0081738873513041137, 	0.0081717288367839681, 	0.0081695144539074612, 	
0.0081672442178137919, 	0.0081649181440242562, 	0.0081625362484415414, 	0.0081600985473502564, 	
0.0081576050574164172, 	0.0081550557956873403, 	0.0081524507795920666, 	0.0081497900269402526, 	
0.0081470735559231056, 	0.0081443013851124381, 	0.0081414735334609818, 	0.0081385900203022402, 	
0.0081356508653500793, 	0.0081326560886989061, 	0.0081296057108233982, 	0.0081264997525782399, 	
0.0081233382351982974, 	0.0081201211802982131, 	0.0081168486098721869, 	0.0081135205462941149, 	
0.0081101370123173536, 	0.0081066980310742724, 	0.0081032036260764856, 	0.0080996538212144819, 	
0.0080960486407575648, 	0.008092388109353579, 	0.0080886722520287554, 	0.0080849010941875955, 	
0.0080810746616127131, 	0.0080771929804645884, 	0.0080732560772815275, 	0.0080692639789791271, 	
0.0080652167128506935, 	0.0080611143065664956, 	0.0080569567881736918, 	0.0080527441860962761, 	
0.0080484765291351582, 	0.0080441538464672592, 	0.0080397761676458471, 	0.0080353435226000781, 	
0.0080308559416351257, 	0.0080263134554315035, 	0.0080217160950453795, 	0.00801706389190774, 	
0.0080123568778248857, 	0.008007595084977422, 	0.0080027785459209008, 	0.007997907293584931, 	
0.0079929813612731482, 	0.0079880007826631169, 	0.007982965591806012, 	0.0079778758231264235, 	
0.0079727315114218236, 	0.0079675326918628945, 	0.0079622793999929442, 	0.0079569716717273475, 	
0.0079516095433540979, 	0.0079461930515328308, 	0.0079407222332950524, 	0.0079351971260433994, 	
0.0079296177675519178, 	0.0079239841959655583, 	0.0079182964497998016, 	0.0079125545679405371, 	
0.0079067585896437191, 	0.007900908554535244, 	0.0078950045026105684, 	0.007889046474234454, 	
0.0078830345101406057, 	0.0078769686514315752, 	0.007870848939578361, 	0.0078646754164200163, 	
0.0078584481241635844, 	0.0078521671053839327, 	0.007845832403022791, 	0.0078394440603893507, 	
0.0078330021211592184, 	0.0078265066293745859, 	0.0078199576294437322, 	0.0078133551661407966, 	
0.007806699284605422, 	0.0077999900303423325, 	0.0077932274492213639, 	0.0077864115874767504, 	
0.0077795424917071771, 	0.0077726202088750822, 	0.0077656447863067172, 	0.007758616271691398, 	
0.0077515347130817534, 	0.0077444001588928236, 	0.0077372126579019667, 	0.0077299722592485661, 	
0.0077226790124337802, 	0.0077153329673199152, 	0.0077079341741303087, 	0.0077004826834488659, 	
0.0076929785462199517, 	0.0076854218137475836, 	0.0076778125376956762, 	0.0076701507700872125, 	
0.0076624365633038982, 	0.0076546699700862286, 	0.007646851043532691, 	0.007638979837099674, 	
0.0076310564046008639, 	0.0076230808002070334, 	0.0076150530784457916, 	0.0076069732942008611, 	
0.0075988415027119904, 	0.0075906577595745185, 	0.0075824221207390213, 	0.0075741346425106677, 	
0.0075657953815492203, 	0.0075574043948683379, 	0.0075489617398355763, 	0.007540467474171423, 	
0.0075319216559492789, 	0.007523324343595309, 	0.0075146755958873292, 	0.0075059754719549437, 	
0.0074972240312790569, 	0.0074884213336914611, 	0.0074795674393741945, 	0.00747066240885964, 	
0.007461706303029318, 	0.0074526991831143693, 	0.0074436411106944675, 	0.0074345321476977713, 	
0.007425372356400315, 	0.0074161617994255198, 	0.0074069005397440204, 	0.0073975886406732246, 	
0.0073882261658763815, 	0.0073788131793627552, 	0.0073693497454869689, 	0.0073598359289485209, 	
0.0073502717947913215, 	0.0073406574084031988, 	0.0073309928355157292, 	0.0073212781422035376, 	
0.0073115133948838344, 	0.0073016986603161626, 	0.007291834005601714, 	0.0072819194981831323, 	
0.0072719552058436252, 	0.007261941196706985, 	0.0072518775392368022, 	0.0072417643022362381, 	
0.0072316015548472262, 	0.0072213893665502753, 	0.0072111278071640581, 	0.0072008169468445217, 	
0.0071904568560848918, 	0.0071800476057148847, 	0.007169589266900203, 	0.0071590819111423494, 	
0.0071485256102778528, 	0.0071379204364778711, 	0.0071272664622477168, 	0.0071165637604263358, 	
0.0071058124041857296, 	0.0070950124670307061, 	0.0070841640227980538, 	0.007073267145656285, 	
0.0070623219101049912, 	0.0070513283909744507, 	0.0070402866634249059, 	0.0070291968029463541, 	
0.0070180588853577235, 	0.0070068729868066719, 	0.0069956391837687334, 	0.0069843575530469876, 	
0.0069730281717714651, 	0.0069616511173988278, 	0.0069502264677115374, 	0.0069387543008174206, 	
0.0069272346951491917, 	0.0069156677294640893, 	0.0069040534828427452, 	0.006892392034689456, 	
0.0068806834647309337, 	0.0068689278530162656, 	0.006857125279915886, 	0.0068452758261216646, 	
0.006833379572645553, 	0.0068214366008197864, 	0.0068094469922959436, 	0.0067974108290443707, 	
0.0067853281933536709, 	0.0067731991678302789, 	0.0067610238353977975, 	0.0067488022792963186, 	
0.0067365345830819557, 	0.0067242208306263242, 	0.006711861106115922, 	0.0066994554940515861, 	
0.0066870040792477445, 	0.0066745069468320825, 	0.0066619641822448176, 	0.0066493758712381562, 	
0.0066367420998756331, 	0.0066240629545316872, 	0.0066113385218908756, 	0.0065985688889474035, 	
0.0065857541430045102, 	0.0065728943716739027, 	0.0065599896628750504, 	0.0065470401048346918, 	
0.0065340457860862391, 	0.0065210067954688212, 	0.0065079232221275096, 	0.0064947951555116993, 	
0.0064816226853752577, 	0.0064684059017755084, 	0.0064551448950728105, 	0.0064418397559297619, 	
0.0064284905753106969, 	0.0064150974444811965, 	0.0064016604550072671, 	0.0063881796987544821, 	
0.0063746552678880892, 	0.0063610872548717631, 	0.0063474757524669499, 	0.006333820853732566, 	
0.0063201226520243235, 	0.0063063812409938072, 	0.0062925967145881379, 	0.0062787691670492148, 	
0.006264898692912883, 	0.0062509853870087511, 	0.0062370293444589863, 	0.0062230306606780601, 	
0.0062089894313720985, 	0.0061949057525377835, 	0.0061807797204623529, 	0.0061666114317223027, 	
0.0061524009831834077, 	0.0061381484719993063, 	0.0061238539956113046, 	0.006109517651747799, 	
0.0060951395384233418, 	0.0060807197539377101, 	0.0060662583968762234, 	0.0060517555661079268, 	
0.0060372113607855132, 	0.0060226258803446646, 	0.006007999224503179, 	0.005993331493260352, 	
0.0059786227868962689, 	0.0059638732059712745, 	0.0059490828513250578, 	0.0059342518240760164, 	
0.0059193802256208884, 	0.0059044681576334032, 	0.0058895157220642909, 	0.0058745230211400953, 	
0.0058594901573627177, 	0.0058444172335086779, 	0.0058293043526281597, 	0.0058141516180448107, 	
0.0057989591333546349, 	0.0057837270024253306, 	0.0057684553293956995, 	0.0057531442186749644, 	
0.0057377937749418882, 	0.0057224041031440822, 	0.0057069753084975404, 	0.0056915074964855438, 	
0.00567600077285814, 	0.0056604552436316843, 	0.0056448710150873794, 	0.005629248193771432, 	
0.0056135868864936401, 	0.0055978872003270026, 	0.0055821492426069447, 	0.0055663731209305107, 	
0.0055505589431555187, 	0.0055347068174002511, 	0.0055188168520422876, 	0.0055028891557178158, 	
0.0054869238373212214, 	0.005470921006003846, 	0.0054548807711735994, 	0.0054388032424941774, 	
0.0054226885298841922, 	0.0054065367435164741, 	0.0053903479938173212, 	0.00537412239146569, 	
0.0053578600473927086, 	0.005341561072780312, 	0.0053252255790612393, 	0.0053088536779176436, 	
0.0052924454812808205, 	0.0052760011013300223, 	0.0052595206504919365, 	0.0052430042414397787, 	
0.0052264519870929187, 	0.005209864000615465, 	0.0051932403954159517, 	0.0051765812851462941, 	
0.0051598867837012452, 	0.0051431570052176091, 	0.0051263920640733669, 	0.0051095920748866512, 	
0.0050927571525155365, 	0.0050758874120567293, 	0.0050589829688449522, 	0.0050420439384522894, 	
0.0050250704366872709, 	0.0050080625795941008, 	0.0049910204834517878, 	0.0049739442647735981, 	
0.0049568340403058865, 	0.0049396899270276245, 	0.004922512042149386, 	0.0049053005031126848, 	
0.0048880554275892059, 	0.0048707769334797504, 	0.004853465138913657, 	0.0048361201622480693, 	
0.0048187421220667595, 	0.0048013311371796728, 	0.0047838873266220329, 	0.0047664108096533786, 	
0.0047489017057568989, 	0.0047313601346385906, 	0.0047137862162264614, 	0.0046961800706695079, 	
0.0046785418183373463, 	0.00466087157981869, 	0.0046431694759214402, 	0.0046254356276707988, 	
0.004607670156309444, 	0.0045898731832960653, 	0.0045720448303047685, 	0.0045541852192241385, 	
0.0045362944721565298, 	0.0045183727114171358, 	0.0045004200595331828, 	0.0044824366392431335, 	
0.0044644225734956893, 	0.0044463779854491646, 	0.0044283029984706502, 	0.0044101977361348382, 	
0.0043920623222235841, 	0.0043738968807247244, 	0.0043557015358316143, 	0.0043374764119419248, 	
0.0043192216336567432, 	0.0043009373257801905, 	0.0042826236133181751, 	0.0042642806214775826, 	
0.0042459084756655743, 	0.0042275073014885018, 	0.0042090772247512153, 	0.0041906183714562522, 	
0.0041721308678027971, 	0.0041536148401859754, 	0.0041350704151958415, 	0.0041164977196167804, 	
0.0040978968804261801, 	0.0040792680247940293, 	0.0040606112800818783, 	0.0040419267738418278, 	
0.0040232146338158399, 	0.004004474987934761, 	0.0039857079643176177, 	0.0039669136912704409, 	
0.0039480922972856946, 	0.0039292439110412049, 	0.0039103686613993502, 	0.0038914666774061799, 	
0.0038725380882904132, 	0.0038535830234627932, 	0.0038346016125150365, 	0.003815593985219007, 	
0.0037965602715258058, 	0.0037775006015647243, 	0.0037584151056427508, 	0.0037393039142432603, 	
0.0037201671580254915, 	0.0037010049678229862, 	0.0036818174746439045, 	0.0036626048096689281, 	
0.0036433671042508269, 	0.0036241044899138295, 	0.0036048170983520606, 	0.0035855050614294419, 	
0.0035661685111782293, 	0.0035468075797982349, 	0.0035274223996559057, 	0.0035080131032836806, 	
0.003488579823378698, 	0.0034691226928022156, 	0.0034496418445783233, 	0.0034301374118934258, 	
0.0034106095280952036, 	0.0033910583266915559, 	0.0033714839413498598, 	0.0033518865058960569, 	
0.0033322661543135701, 	0.0033126230207423763, 	0.0032929572394786275, 	0.0032732689449728497, 	
0.0032535582718298153, 	0.0032338253548070766, 	0.003214070328814433, 	0.0031942933289127182, 	
0.0031744944903129711, 	0.0031546739483757158, 	0.003134831838609623, 	0.0031149682966710745, 	
0.0030950834583627252, 	0.0030751774596330826, 	0.0030552504365750151, 	0.003035302525425432, 	
0.0030153338625638474, 	0.0029953445845118235, 	0.0029753348279316061, 	0.0029553047296258014, 	
0.0029352544265357655, 	0.002915184055741107, 	0.0028950937544587204, 	0.0028749836600415993, 	
0.0028548539099782833, 	0.0028347046418913742, 	0.0028145359935371874, 	0.0027943481028044441, 	
0.0027741411077134531, 	0.0027539151464150307, 	0.0027336703571897852, 	0.0027134068784469608, 	
0.002693124848723626, 	0.0026728244066836927, 	0.002652505691116901, 	0.0026321688409379311, 	
0.0026118139951855756, 	0.0025914412930213757, 	0.0025710508737291911, 	0.0025506428767139884, 	
0.0025302174415008159, 	0.0025097747077340604, 	0.0024893148151762185, 	0.0024688379037072741, 	
0.0024483441133233679, 	0.0024278335841362033, 	0.0024073064563718506, 	0.002386762870369959, 	
0.0023662029665825132, 	0.0023456268855733043, 	0.0023250347680163399, 	0.0023044267546957621, 	
0.002283802986503988, 	0.0022631636044413367, 	0.0022425087496148362, 	0.0022218385632373598, 	
0.0022011531866263688, 	0.0021804527612035844, 	0.0021597374284931122, 	0.002139007330121461, 	
0.0021182626078157878, 	0.002097503403403251, 	0.0020767298588101001, 	0.0020559421160606323, 	
0.0020351403172761419, 	0.0020143246046742348, 	0.0019934951205672065, 	0.0019726520073620009, 	
0.0019517954075583734, 	0.0019309254637485196, 	0.0019100423186156536, 	0.0018891461149334395, 	
0.0018682369955647334, 	0.0018473151034606957, 	0.0018263805816598753, 	0.0018054335732869879, 	
0.0017844742215522974, 	0.0017635026697504575, 	0.0017425190612593913, 	0.0017215235395395582, 	
0.0017005162481328418, 	0.0016794973306616546, 	0.0016584669308277354, 	0.0016374251924114569, 	
0.0016163722592706289, 	0.00159530827533985, 	0.0015742333846288504, 	0.0015531477312221845, 	
0.001532051459278001, 	0.0015109447130269441, 	0.0014898276367714687, 	0.0014687003748842628, 	
0.0014475630718081003, 	0.0014264158720541807, 	0.001405258920201322, 	0.0013840923608951269, 	
0.001362916338846781, 	0.0013417309988323052, 	0.001320536485691369, 	0.0012993329443262681, 	
0.0012781205197012464, 	0.0012568993568408768, 	0.0012356696008299351, 	0.0012144313968117009, 	
0.0011931848899874096, 	0.001171930225614732, 	0.0011506675490073307, 	0.001129397005533802, 	
0.0011081187406161842, 	0.0010868328997296133, 	0.0010655396284009416, 	0.0010442390722076719, 	
0.001022931376777472, 	0.0010016166877864594, 	0.00098029515095885236, 	0.00095896691206567928, 	
0.00093763211692353833, 	0.00091629091139430296, 	0.00089494344138355681, 	0.0008735898528395013, 	
0.00085223029175255944, 	0.00083086490415387911, 	0.00080949383611465234, 	0.0007881172337447799, 	
0.00076673524319226271, 	0.00074534801064203755, 	0.00072395568231512332, 	0.00070255840446736329, 	
0.00068115632338894532, 	0.00065974958540259505, 	0.00063833833686414781, 	0.00061692272416004085, 	
0.00059550289370737723, 	0.00057407899195271333, 	0.00055265116537139478, 	0.0005312195604667148, 	
0.00050978432376967882, 	0.00048834560183771427, 	0.00046690354125506953, 	0.00044545828863260884, 	
0.0004240099906079187, 	0.00040255879384666393, 	0.0003811048450443071, 	0.00035964829092947545, 	
0.00033818927827010799, 	0.00031672795388284418, 	0.00029526446464949314, 	0.00027379895754508214, 	
0.00025233157968739244, 	0.00023086247842665775, 	0.00020939180151676267, 	0.00018791969745967152, 	
0.00016644631624473228, 	0.00014497181107403148, 	0.0001234963428279235, 	0.00010202009328478848, 	
8.0543312094775782e-05, 	5.9066533928031779e-05, 	3.7592109765625085e-05, 	1.6149179940346393e-05, 	
};

complex<double> Numerics::gaussInt(function<complex<double>(complex<double>)> func) {
  complex<double> I(0., 1.);
  complex<double> sum(0.0, 0.0);
  for( int i = 0; i < 1201; i++) {
    complex<double> x = -exp(I*Numerics::gaulegX[i]);
    sum += func(x)*Numerics::gaulegW[i];
  }
  return sum;
}

complex<double> Numerics::complexContourIntegral(function<complex<double>(complex<double>)> f) {
  auto gamma = [](double t) {
                 complex<double> I(0., 1.);
                 return exp(I*t);
               };

  auto func = [&](double t) {
                return f(gamma(t));
              };

  return integrateComplex(func, -M_PI, M_PI);
}


// from https://gist.github.com/lilac/2464434
bool Numerics::invertMatrix (const ublas::matrix<double>& input, ublas::matrix<double>& inverse) {
  using namespace boost::numeric::ublas;
  typedef permutation_matrix<std::size_t> pmatrix;

  // create a working copy of the input
  matrix<double> A(input);
  // create a permutation matrix for the LU-factorization
  pmatrix pm(A.size1());

  // perform LU-factorization
  int res = lu_factorize(A,pm);
  if( res != 0 ) return false;

  // create identity matrix of "inverse"
  inverse.assign(ublas::identity_matrix<double>(A.size1()));

  // backsubstitute to get the inverse
  lu_substitute(A, pm, inverse);
  // testInvMat(input, inverse);

  return true;
}


// method described in: http://math.uww.edu/~mcfarlat/inverse.htm
bool Numerics::invMat(const ublas::matrix<double> &mat, ublas::matrix<double> &invMat) {
  int n = mat.size1();

  // Augment input matrix with an identity matrix
  ublas::matrix<double> augmat(n, 2*n);
  for(int i=0; i<n; i++) {
    for(int j=0; j<2*n; j++) {
      if( j<n) {
        augmat(i, j) = mat(i, j);
      } else if((i+n) == j) {
        augmat(i, j) = 1.0;
      } else {
        augmat(i, j) = 0.0;
      }
    }
  }

  // loop through pivots
  for(int p=0; p<n; p++) {
    double pEl = augmat(p, p); // pivot element;
    // normalize pivot to 1 ( divide whole row through pivot element )
    for(int col=0; col<2*n; col++) {
      augmat(p, col) = augmat(p, col)/pEl;
    }
    // loop through pivot-row
    for(int row=0; row<n; row++) {
      // set every row element ( except pivot element ) to 0
      // by subtracting a multiple of the pivot row
      if(row != p) {
        double facEl = augmat(row, p);
        for(int col=0; col<2*n; col++) {
          augmat(row, col) = augmat(row, col) - facEl*augmat(p, col);
        }
      }
    }
  }

  // get inverse Matrix from right side of augmented matrix
  for(int row=0; row<n; row++) {
    for(int col=0; col<n; col++) {
      invMat(row, col) = augmat(row, col+n);
    }
  }

  testInvMat(mat, invMat);


  return true;
}

void Numerics::testInvMat(
  const ublas::matrix<double> &mat,
  const ublas::matrix<double> &invMat
) {
  const int n = mat.size1();
  ublas::matrix<double> onemat(n, n);
  for(int i=0; i<n; i++) {
    for(int j=0; j<n; j++) {
      for(int k=0; k<n; k++) {
        onemat(i,j) += invMat(i,k)*mat(k,j);
      }
    }
  }

  // namespace karma = boost::spirit::karma;
  // using namespace karma;
  // std::cout << "inverse Matrix test:" << std::endl;
  // std::cout << format_delimited(columns(onemat.size2()) [auto_], '\t', onemat.data()) << std::endl;
};

double Numerics::gslFixedPointLegendre(function<double(double)> func, double from, double to) {
  double result;
  gsl_integration_fixed_workspace * q;
  const gsl_integration_fixed_type * T = gsl_integration_fixed_legendre;
  q = gsl_integration_fixed_alloc(T, 1200, from, to, 0.0, 0.0);

  gsl_function F;
  F = {
    [](double d, void* vf) -> double {
      auto& f = *static_cast<std::function<double(double)>*>(vf);
      return f(d);
    },
    &func
  };

  gsl_integration_fixed(&F, &result, q);

  return result;
}

complex<double> Numerics::newtonRaphson(
  function<complex<double>(complex<double>)> f,
  function<complex<double>(complex<double>)> df,
  complex<double> x0,
  double acc
) {
  complex<double> xNext = x0;
  while( abs(f(xNext)) > acc ) {
    xNext = xNext - f(xNext)/df(xNext);
    cout << "N \t" << xNext << endl;
  }
  return xNext;
}

const std::vector<double> Numerics::zeta_ = {
  0,
  0,
  0,
  1.2020569031595942,
  0,
  1.036927755143369926,
  0,
  1.008349277381922827
};

// double semiInfInt(function<double(double)> func, double from) const
// {
//   double result, error;
//   gsl_integration_workspace * w = gsl_integration_workspace_alloc(5000);
//   gsl_function F;
//   F = {
//     [](double d, void* vf) -> double {
//       auto& f = *static_cast<std::function<double(double)>*>(vf);
//       return f(d);
//     },
//     &func
//   };
//   gsl_integration_qagiu(&F, from, epsabs_, epsrel_, 5000, w, &result, &error);
//   return result;
// }

// double qawf(func func, cDbl &omega, cDbl &from) const {
//   double result, error;
//   gsl_integration_workspace * wSpace = gsl_integration_workspace_alloc(1200);
//   gsl_integration_workspace * cycleSpace = gsl_integration_workspace_alloc(1200);

//   gsl_integration_qawo_table *qawoTable = gsl_integration_qawo_table_alloc(omega, 1.0, GSL_INTEG_SINE, 1200);
//   gsl_function F;
//   F = {
//     [](double d, void* vf) -> double {
//       auto& f = *static_cast<std::function<double(double)>*>(vf);
//       return f(d);
//     },
//     &func
//   };

//   gsl_integration_qawf(&F, from, epsabs_, 1200, wSpace, cycleSpace, qawoTable, &result, &error);

//   return result;
// }
